<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Какая книга тебе подходит?</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Inter:wght@400;500;600&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Inter', sans-serif;
    background: #f7f5f0;
    color: #2c2c2c;
    line-height: 1.6;
    min-height: 100vh;
  }

  .container {
    max-width: 640px;
    margin: 0 auto;
    padding: 40px 20px 60px;
  }

  .header {
    text-align: center;
    margin-bottom: 48px;
  }

  .header h1 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 2.2rem;
    font-weight: 600;
    color: #1a1a1a;
    margin-bottom: 12px;
  }

  .header p {
    font-size: 0.95rem;
    color: #666;
    max-width: 440px;
    margin: 0 auto;
  }

  .question-block {
    background: #fff;
    border-radius: 12px;
    padding: 28px;
    margin-bottom: 20px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.06);
    transition: box-shadow 0.2s;
  }

  .question-block:hover {
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  .question-number {
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: #9a8c7a;
    margin-bottom: 8px;
  }

  .question-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.35rem;
    font-weight: 600;
    margin-bottom: 20px;
    color: #1a1a1a;
  }

  .options {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .option {
    display: block;
    padding: 14px 18px;
    border: 1.5px solid #e0dcd4;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.93rem;
    transition: all 0.15s;
    background: #fff;
    text-align: left;
    color: #2c2c2c;
    position: relative;
  }

  .option:hover {
    border-color: #9a8c7a;
    background: #faf8f4;
  }

  .option.selected {
    border-color: #5c4f3a;
    background: #f0ece4;
    font-weight: 500;
  }

  .option.selected::before {
    content: '';
    position: absolute;
    left: -1.5px;
    top: -1.5px;
    bottom: -1.5px;
    width: 4px;
    background: #5c4f3a;
    border-radius: 8px 0 0 8px;
  }

  .submit-area {
    text-align: center;
    margin-top: 40px;
  }

  .submit-btn {
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    padding: 16px 48px;
    border: none;
    border-radius: 8px;
    background: #5c4f3a;
    color: #fff;
    cursor: pointer;
    transition: all 0.2s;
    letter-spacing: 0.3px;
  }

  .submit-btn:hover {
    background: #4a3f2e;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(92,79,58,0.3);
  }

  .submit-btn:disabled {
    background: #c5bfb3;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .unanswered-hint {
    font-size: 0.85rem;
    color: #b0a899;
    margin-top: 12px;
    display: none;
  }

  /* Result */
  .result-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    z-index: 100;
    justify-content: center;
    align-items: center;
    padding: 20px;
    animation: fadeIn 0.3s;
  }

  .result-overlay.visible {
    display: flex;
  }

  .result-card {
    background: #fff;
    border-radius: 16px;
    padding: 40px 32px;
    max-width: 520px;
    width: 100%;
    text-align: center;
    position: relative;
    animation: slideUp 0.4s ease-out;
    max-height: 90vh;
    overflow-y: auto;
  }

  .result-label {
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: #9a8c7a;
    margin-bottom: 16px;
  }

  .result-book {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.9rem;
    font-weight: 600;
    color: #1a1a1a;
    margin-bottom: 6px;
  }

  .result-author {
    font-size: 0.95rem;
    color: #888;
    margin-bottom: 20px;
  }

  .result-genre {
    display: inline-block;
    font-size: 0.8rem;
    font-weight: 500;
    padding: 4px 14px;
    border-radius: 20px;
    background: #f0ece4;
    color: #5c4f3a;
    margin-bottom: 20px;
  }

  .result-description {
    font-size: 0.93rem;
    color: #444;
    line-height: 1.7;
    margin-bottom: 28px;
    text-align: left;
  }

  .result-scores {
    text-align: left;
    border-top: 1px solid #eee;
    padding-top: 20px;
    margin-bottom: 24px;
  }

  .result-scores h3 {
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #9a8c7a;
    margin-bottom: 14px;
  }

  .score-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 10px;
  }

  .score-name {
    font-size: 0.85rem;
    color: #555;
    min-width: 160px;
    flex-shrink: 0;
  }

  .score-bar-bg {
    flex: 1;
    height: 8px;
    background: #f0ece4;
    border-radius: 4px;
    overflow: hidden;
  }

  .score-bar {
    height: 100%;
    background: #5c4f3a;
    border-radius: 4px;
    transition: width 0.6s ease-out;
  }

  .score-bar.winner {
    background: #3a6b5c;
  }

  .close-btn {
    font-family: 'Inter', sans-serif;
    font-size: 0.95rem;
    font-weight: 500;
    padding: 12px 36px;
    border: 1.5px solid #e0dcd4;
    border-radius: 8px;
    background: #fff;
    color: #2c2c2c;
    cursor: pointer;
    transition: all 0.15s;
  }

  .close-btn:hover {
    border-color: #5c4f3a;
    background: #faf8f4;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes slideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @media (max-width: 480px) {
    .container { padding: 24px 16px 40px; }
    .header h1 { font-size: 1.7rem; }
    .question-block { padding: 20px; }
    .question-text { font-size: 1.2rem; }
    .result-card { padding: 28px 20px; }
    .result-book { font-size: 1.5rem; }
    .score-name { min-width: 120px; font-size: 0.8rem; }
  }
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>Какая книга тебе подходит?</h1>
    <p>Ответь на 12 вопросов — и узнаешь, какую из пяти книг стоит прочитать в марте</p>
  </div>

  <div id="quiz"></div>

  <div class="submit-area">
    <button class="submit-btn" id="submitBtn" disabled onclick="showResult()">Узнать результат</button>
    <p class="unanswered-hint" id="hint"></p>
  </div>
</div>

<div class="result-overlay" id="resultOverlay">
  <div class="result-card" id="resultCard"></div>
</div>

<script>
// Books: B=Барнс, I=Исигуро, M=Макьюэн, H=Хейг, O=О'Фаррелл
const books = {
  B: {
    title: '«Предчувствие конца»',
    author: 'Джулиан Барнс',
    genre: 'Психологический роман · ~160 стр.'
  },
  I: {
    title: '«Не отпускай меня»',
    author: 'Кадзуо Исигуро',
    genre: 'Антиутопия / драма · ~350 стр.'
  },
  M: {
    title: '«Искупление»',
    author: 'Иэн Макьюэн',
    genre: 'Драма / военный роман · ~450 стр.'
  },
  H: {
    title: '«Полночная библиотека»',
    author: 'Мэтт Хейг',
    genre: 'Фантастика / философский роман · ~260 стр.'
  },
  O: {
    title: '«Хамнет»',
    author: 'Мэгги О\'Фаррелл',
    genre: 'Исторический роман · ~384 стр.'
  }
};

const questions = [
  {
    q: 'Ты случайно слышишь чужой разговор в кафе. Что зацепит?',
    opts: [
      { text: '«Я двадцать лет был уверен, что всё было не так»', scores: {B:3} },
      { text: '«Мы с ней молчали всю дорогу, но я всё понял»', scores: {I:3} },
      { text: '«Если бы я тогда промолчал, всё сложилось бы иначе»', scores: {M:3} },
      { text: '«Я уволился, переехал — и знаешь, стало только хуже»', scores: {H:2, O:2} }
    ]
  },
  {
    q: 'Тебе подарили билет куда угодно. Куда летишь?',
    opts: [
      { text: 'Лондон — бродить по паркам и думать о жизни', scores: {B:2, I:2} },
      { text: 'Тоскана — вино, закаты, ничего не делать', scores: {M:2, O:2} },
      { text: 'Исландия — тишина, природа, перезагрузка', scores: {H:3} },
      { text: 'Марракеш — запахи, специи, шум базара', scores: {O:3} }
    ]
  },
  {
    q: 'Как ты обычно принимаешь важные решения?',
    opts: [
      { text: 'Анализирую, взвешиваю, строю аргументы', scores: {B:3} },
      { text: 'Долго молчу, потом просто знаю ответ', scores: {I:2, O:2} },
      { text: 'Советуюсь с близкими — мне важен взгляд со стороны', scores: {M:2, H:2} },
      { text: 'Чувствую нутром — тело подсказывает раньше головы', scores: {O:3} }
    ]
  },
  {
    q: 'С каким утверждением ты больше согласен(на)?',
    opts: [
      { text: 'Мы знаем о себе гораздо меньше, чем нам кажется', scores: {B:3} },
      { text: 'Самое страшное — не бунт, а тихое согласие', scores: {I:3} },
      { text: 'Один поступок может определить всю жизнь', scores: {M:3} },
      { text: 'Нет «правильной» жизни — есть та, что ты проживаешь', scores: {H:3} }
    ]
  },
  {
    q: 'Ты смотришь старые школьные фото. О чём думаешь?',
    opts: [
      { text: '«Забавно — я помню всё совсем по-другому»', scores: {B:3} },
      { text: '«Мы ещё ничего не знали о том, что нас ждёт»', scores: {I:3} },
      { text: '«Вон тот момент — после него всё изменилось»', scores: {M:3} },
      { text: '«А если бы я тогда пошёл в другую школу...»', scores: {H:3} }
    ]
  },
  {
    q: 'Какой запах вызывает у тебя самые сильные воспоминания?',
    opts: [
      { text: 'Старые книги или пыльный чердак', scores: {B:2, M:2} },
      { text: 'Дождь на асфальте', scores: {I:3} },
      { text: 'Свежескошенная трава', scores: {H:3} },
      { text: 'Травяной чай или сухие цветы', scores: {O:3} }
    ]
  },
  {
    q: 'Друг переживает тяжёлый момент. Как ты поддержишь?',
    opts: [
      { text: 'Помогу разобраться — разложу ситуацию по полочкам', scores: {B:3} },
      { text: 'Просто буду рядом и помолчу вместе', scores: {I:3} },
      { text: 'Скажу честно, что думаю, даже если это неприятно', scores: {M:3} },
      { text: 'Обниму, сделаю чай, отвлеку чем-то тёплым', scores: {O:2, H:2} }
    ]
  },
  {
    q: 'Воскресенье. Впереди целый свободный день. Ты:',
    opts: [
      { text: 'Сяду с кофе и буду думать — мне нужна тишина для мыслей', scores: {B:3} },
      { text: 'Пойду гулять без плана — просто наблюдать', scores: {I:3} },
      { text: 'Наконец доделаю то, что давно откладывал(а)', scores: {M:2, H:2} },
      { text: 'Что-то руками — готовить, рисовать, возиться в саду', scores: {O:3} }
    ]
  },
  {
    q: 'Идеальный вечер с друзьями — это:',
    opts: [
      { text: 'Долгий разговор за вином, где все спорят', scores: {B:2, M:2} },
      { text: 'Тихие посиделки — мало слов, но всё понятно', scores: {I:3} },
      { text: 'Шумный ужин с историями и воспоминаниями', scores: {M:1, O:3} },
      { text: 'Настолки, смех, лёгкая атмосфера', scores: {H:3} }
    ]
  },
  {
    q: 'Что ты ценишь в людях больше всего?',
    opts: [
      { text: 'Честность с собой — даже когда это некомфортно', scores: {B:3} },
      { text: 'Способность чувствовать чужую боль', scores: {I:3, O:1} },
      { text: 'Смелость признать ошибку', scores: {M:3} },
      { text: 'Умение радоваться тому, что есть', scores: {H:3} }
    ]
  },
  {
    q: 'Тебе 80 лет. О чём ты, скорее всего, будешь жалеть?',
    opts: [
      { text: 'Что не разобрался до конца в себе и своих мотивах', scores: {B:3} },
      { text: 'Что принимал как должное то, что было дорого', scores: {I:3} },
      { text: 'Что не извинился вовремя', scores: {M:3} },
      { text: 'Что побоялся попробовать другой путь', scores: {H:3} }
    ]
  },
  {
    q: 'И последнее. Выбери фразу, которая тебе ближе:',
    opts: [
      { text: '«Мы не то, что с нами случилось. Мы — то, что мы об этом рассказали»', scores: {B:3} },
      { text: '«Иногда самое важное — то, о чём мы не говорим»', scores: {I:3} },
      { text: '«Невозможно прожить жизнь, никому не навредив»', scores: {M:3, O:1} },
      { text: '«Единственная жизнь, которую стоит прожить — та, что у тебя есть»', scores: {H:3} }
    ]
  }
];

const answers = {};

function render() {
  const quiz = document.getElementById('quiz');
  quiz.innerHTML = questions.map((q, i) => `
    <div class="question-block" id="q${i}">
      <div class="question-number">Вопрос ${i + 1} из ${questions.length}</div>
      <div class="question-text">${q.q}</div>
      <div class="options">
        ${q.opts.map((o, j) => `
          <button class="option" data-q="${i}" data-o="${j}" onclick="select(${i},${j})">
            ${o.text}
          </button>
        `).join('')}
      </div>
    </div>
  `).join('');
}

function select(qi, oi) {
  answers[qi] = oi;
  document.querySelectorAll(`[data-q="${qi}"]`).forEach(el => el.classList.remove('selected'));
  document.querySelector(`[data-q="${qi}"][data-o="${oi}"]`).classList.add('selected');
  updateBtn();
}

function updateBtn() {
  const answered = Object.keys(answers).length;
  const btn = document.getElementById('submitBtn');
  const hint = document.getElementById('hint');
  if (answered === questions.length) {
    btn.disabled = false;
    hint.style.display = 'none';
  } else {
    btn.disabled = true;
    hint.style.display = 'block';
    hint.textContent = `Отвечено ${answered} из ${questions.length}`;
  }
}

function showResult() {
  const scores = {B:0, I:0, M:0, H:0, O:0};
  for (const [qi, oi] of Object.entries(answers)) {
    const s = questions[qi].opts[oi].scores;
    for (const [book, pts] of Object.entries(s)) {
      scores[book] += pts;
    }
  }

  const maxScore = Math.max(...Object.values(scores));
  const winner = Object.keys(scores).find(k => scores[k] === maxScore);
  const book = books[winner];

  const sortedScores = Object.entries(scores).sort((a,b) => b[1] - a[1]);

  const card = document.getElementById('resultCard');
  card.innerHTML = `
    <div class="result-label">Тебе подходит</div>
    <div class="result-book">${book.title}</div>
    <div class="result-author">${book.author}</div>
    <div class="result-genre">${book.genre}</div>
    <div class="result-scores">
      <h3>Все результаты</h3>
      ${sortedScores.map(([key, score]) => `
        <div class="score-row">
          <span class="score-name">${books[key].title}</span>
          <div class="score-bar-bg">
            <div class="score-bar ${key === winner ? 'winner' : ''}" style="width: ${maxScore > 0 ? (score / maxScore * 100) : 0}%"></div>
          </div>
        </div>
      `).join('')}
    </div>
    <button class="close-btn" onclick="closeResult()">Закрыть</button>
  `;

  document.getElementById('resultOverlay').classList.add('visible');
  document.body.style.overflow = 'hidden';
}

function closeResult() {
  document.getElementById('resultOverlay').classList.remove('visible');
  document.body.style.overflow = '';
}

document.getElementById('resultOverlay').addEventListener('click', function(e) {
  if (e.target === this) closeResult();
});

render();
updateBtn();
</script>

</body>
</html>
